# kaiax/builder

This module is responsible for implementing utility functions and APIs for workers, specified in [KIP-245](https://kips.kaia.io/KIPs/kip-245).

## Concepts

This module provides utility functions. See getters section for details.

## Persistent schema

This module does not persist any data.

### Bundle

`Bundle` is a set of transactions and transaction generators in addition to its location.
Properties of bundle is specified in [KIP-245](https://kips.kaia.io/KIPs/kip-245).

See [bundle.go](./bundle.go).

### TxOrGen

`TxOrGen` is either a transaction or a transaction generator.

- `GetTx(nonce uint64) (*types.Transaction, error)` returns either the underlying concrete transaction, or a transaction generated by the underlying transaction generator.

## APIs

### kaia_sendRawTransactions

Send multiple transactions at once.

- Parameters
  - `txList`: a list of RLP-encoded transactions (e.g., `[RlpEncodedTx1, RlpEncodedTx2]`)
- Returns
  - `hashList`: a list of transaction hashes

## Getters

- `IncorporateBundleTx(txs []*types.Transaction, bundles []*builder.Bundle) ([]*builder.TxOrGen, error)`: Incorporate bundles to transaction list to have a new reordered list of TxOrGen.
- `Arrayify(heap *types.TransactionsByPriceAndNonce) []*types.Transaction`: Flatten transaction heap.
- `IsConflict(prevBundles []*builder.Bundle, newBundles []*builder.Bundle) bool`: Check if `newBundles` have any conflict with `prevBundles`.
- `ExtractBundlesAndIncorporate(arrayTxs []*types.Transaction, txBundlingModules []kaiax.TxBundlingModule) ([]*builder.TxOrGen, []*builder.Bundle)`: Extracts bundles from given modules and incorporates non-conflicting bundles.
