name: Testing Workflow

on:
  push:
    tags:
      - 'v*.*.*'
    branches:
      - 'main'
      - 'release/**'
      - 'test/github-action'
  pull_request:
    branches:
      - 'main'
jobs:
#  build:
#    runs-on: ubuntu-latest
#    container:
#      image: kaiachain/build_base:1.12-go.1.22.1-solc0.8.13-ubuntu-20.04
#    permissions:
#      id-token: write
#      contents: write
#    steps:
#      - name: Check out code
#        uses: actions/checkout@v4
#      - name: Build
#        run: |
#          git config --global --add safe.directory /__w/kaia/kaia
#          make all
  test-linter:
    runs-on: ubuntu-latest
    container:
      image: kaiachain/build_base:1.12-go.1.22.1-solc0.8.13-ubuntu-20.04
    steps:
      - name: Check out code
        uses: actions/checkout@v4
      - name: Download dev branch
        run: |
          git config --global --add safe.directory /__w/kaia/kaia
          git fetch origin dev:dev
      - name: Run golangci-lint
        run: |
          git config --global --add safe.directory /__w/kaia/kaia
          go run build/ci.go lint -v --new-from-rev=dev
#  test-networks:
#    runs-on: ubuntu-latest
#    container:
#      image: kaiachain/build_base:1.12-go.1.22.1-solc0.8.13-ubuntu-20.04
#    steps:
#      - name: Run test networks
#        run: |
#          git config --global --add safe.directory /__w/kaia/kaia
#          make test-networks